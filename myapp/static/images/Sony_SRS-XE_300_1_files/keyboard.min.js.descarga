!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):((e="undefined"!=typeof globalThis?globalThis:e||self).flowplayer=e.flowplayer||{},e.flowplayer.keyboard=t())}(this,(function(){"use strict";function e(e,t,n){const i=function(e){return Array.isArray(e)?e.slice(0):e.split(".")}(t);for(;i.length;){if(null==e)return n;const t=i.shift();if("string"!=typeof t)return n;e=e[t]}return null==e?n:e}function t(e,t,n){const i=function(e,t){const n=new CustomEvent(e,{detail:t,cancelable:!0});return t&&Object.defineProperty(n,"data",{get:()=>t}),n}(t,n);return e.dispatchEvent(i),e}!function(){let e=!1;try{const t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassive",null,t),window.removeEventListener("testPassive",null,t)}catch(e){}}();var n={TAB:9,ENTER:13,ESCAPE:27,SPACE:32,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,F:70,H:72,J:74,K:75,L:76,M:77};let i=void 0;function o(e){e.setState("is-kb-active",!0),clearTimeout(i),i=setTimeout((function(){e.setState("is-kb-active",!1)}),2500)}function r(e,t){e.enqueueSeek(t)&&o(e)}let s=void 0;const u=[n.ARROW_UP,n.ARROW_RIGHT,n.ARROW_LEFT,n.ARROW_DOWN],a=[n.SPACE,n.F,n.ESCAPE,n.M,n.ARROW_UP,n.ARROW_DOWN,n.ARROW_RIGHT,n.ARROW_LEFT,n.H,n.J,n.K,n.L];function c(e,t){e.volume=function(e,t,n=0){return Math.max(Math.min(t,e),n)}(e.volume+t,1,0),o(e)}function l(e,t){return!(t.altKey||t.shiftKey||t.metaKey||t.ctrlKey)&&(!!(e&&e.in_viewport&&e.started)&&(!!e.root&&(function(e){let t=document.activeElement;for(;t;){if(t===e)return!0;t=t.parentElement}return!1}(e.root)||document.activeElement===document.body)))}function f(e){e.preventDefault(),e.stopPropagation()}function d(e,t){return!!R(e,t)}function R(e,t){return!!e.parentElement&&(e.parentElement.matches(t)?e.parentElement:d(e.parentElement,t))}document.addEventListener("keydown",(function(i){setTimeout((function(){i.defaultPrevented||function(i){const o=i.which,p=s,A=e(p,"opts.keyboard.seek_step",5),y=document.activeElement;if(!y)return;if(!p)return;if((o===n.SPACE||o===n.ENTER)&&y.hasAttribute("tabindex")&&d(y,".flowplayer"))return y.dispatchEvent(new MouseEvent("click",{bubbles:!0})),f(i);if(~u.indexOf(o)&&y.hasAttribute("aria-valuenow")){const e=~[n.ARROW_UP,n.ARROW_RIGHT].indexOf(o);if(y.matches(".fp-volume"))return c(p,e?.15:-.15),f(i);if(y.matches(".fp-timeline"))return r(p,e?A:-1*A),f(i)}if((o===n.ARROW_DOWN||o===n.ARROW_UP||o===n.ESCAPE)&&d(y,".fp-menu"))return i.preventDefault(),o===n.ARROW_DOWN&&y.nextSibling&&y.nextSibling.focus(),o===n.ARROW_UP&&y.previousSibling&&y.nextSibling.focus(),void(o===n.ESCAPE&&t(p.root,"menu:toggle:open",{open:!1,menu:R(y,".fp-menu")}));if(o===n.TAB){const e=window.flowplayer;e&&Array.isArray(e.instances)&&e.instances.forEach((function(e){e.setState("is-hovered",!0),e.setState("is-accessibility",!0)}))}if(!l(p,i))return;const E=!p.hasState("no-timeline");switch(~a.indexOf(o)&&i.preventDefault(),o){case n.SPACE:return p.togglePlay();case n.F:return p.toggleFullScreen();case n.ESCAPE:return p.toggleFullScreen(!1);case n.M:return p.toggleMute();case n.ARROW_UP:case n.K:return c(p,.15);case n.ARROW_DOWN:case n.J:return c(p,-.15);case n.ARROW_RIGHT:case n.L:return E&&r(p,A);case n.ARROW_LEFT:case n.H:E&&r(p,-1*A)}}(i)}),0)}));class Keyboard{init(e,t,n){n.on(["loadstart","playing","fullscreenenter"],(function(){s=n}))}}return function(e,t){if("object"==typeof exports&&"undefined"!=typeof module)return t;"flowplayer"in e||(e.flowplayer={extensions:[]});const n=e.flowplayer;"function"==typeof n?n(t):(Array.isArray(n.extensions)||(n.extensions=[]),~n.extensions.indexOf(t)||n.extensions.push(t))}(window,Keyboard),Keyboard}));
